(()=>{"use strict";const e=window.wp.blocks,t=window.wp.i18n,s=window.wp.blockEditor,i=window.wp.components,a=window.wp.element,n=window.ReactJSXRuntime;(0,e.registerBlockType)("dude/pricing-category",{edit:function({attributes:e,setAttributes:o}){const{categoryTitle:l,categoryDescription:r,items:c}=e,[d,u]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),x=(0,s.useBlockProps)({className:"block block-pricing-category has-unified-padding-if-stacked"}),m=(e,t,s)=>{const i=[...c];i[e]={...i[e],[t]:s},o({items:i})},g=(e,t)=>{const s=[...c],i=e+t;i<0||i>=c.length||([s[e],s[i]]=[s[i],s[e]],o({items:s}))},j=e=>{h(p===e?null:e)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.InspectorControls,{children:[(0,n.jsx)(i.PanelBody,{title:(0,t.__)("Kategorian asetukset","dude"),children:(0,n.jsx)("p",{style:{color:"#757575",fontSize:"12px"},children:(0,t.__)("Muokkaa kategorian otsikkoa ja kuvausta suoraan lohkossa. Lisää ja muokkaa tuotteita alla.","dude")})}),c.map((e,s)=>(0,n.jsxs)(i.PanelBody,{title:e.title||`Tuote ${s+1}`,initialOpen:d===s,onToggle:()=>u(d===s?null:s),children:[(0,n.jsx)(i.TextControl,{label:(0,t.__)("Otsikko","dude"),value:e.title,onChange:e=>m(s,"title",e)}),(0,n.jsx)(i.ToggleControl,{label:(0,t.__)("Suosituin","dude"),checked:e.isPopular,onChange:e=>m(s,"isPopular",e)}),(0,n.jsx)(i.TextControl,{label:(0,t.__)("Hinta","dude"),value:e.price,onChange:e=>m(s,"price",e)}),(0,n.jsx)(i.TextControl,{label:(0,t.__)("Lyhyt kuvaus","dude"),value:e.shortDescription,onChange:e=>m(s,"shortDescription",e)}),(0,n.jsx)(i.TextareaControl,{label:(0,t.__)("Sisältö (avattu)","dude"),value:e.content,onChange:e=>m(s,"content",e)}),(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:(0,t.__)("Ominaisuudet","dude")})}),(e.features||[]).map((e,a)=>(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[(0,n.jsx)(i.TextControl,{value:e,onChange:e=>((e,t,s)=>{const i=[...c],a=[...i[e].features];a[t]=s,i[e]={...i[e],features:a},o({items:i})})(s,a,e),style:{flex:1}}),(0,n.jsx)(i.Button,{isDestructive:!0,variant:"secondary",onClick:()=>((e,t)=>{const s=[...c],i=s[e].features.filter((e,s)=>s!==t);s[e]={...s[e],features:i},o({items:s})})(s,a),style:{flexShrink:0},children:(0,t.__)("Poista","dude")})]},a)),(0,n.jsx)(i.Button,{variant:"secondary",onClick:()=>(e=>{const t=[...c],s=[...t[e].features||[],"Uusi ominaisuus"];t[e]={...t[e],features:s},o({items:t})})(s),style:{marginBottom:"16px"},children:(0,t.__)("+ Lisää ominaisuus","dude")}),(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"16px",borderTop:"1px solid #ddd",paddingTop:"16px"},children:[(0,n.jsx)(i.Button,{variant:"secondary",onClick:()=>g(s,-1),disabled:0===s,children:(0,t.__)("Ylös","dude")}),(0,n.jsx)(i.Button,{variant:"secondary",onClick:()=>g(s,1),disabled:s===c.length-1,children:(0,t.__)("Alas","dude")}),(0,n.jsx)(i.Button,{isDestructive:!0,onClick:()=>(e=>{const t=c.filter((t,s)=>s!==e);o({items:t})})(s),children:(0,t.__)("Poista tuote","dude")})]})]},e.id||s)),(0,n.jsx)(i.PanelBody,{children:(0,n.jsx)(i.Button,{variant:"primary",onClick:()=>{const e=[...c,{id:Date.now(),title:"Uusi tuote",isPopular:!1,price:"0 €",shortDescription:"Lyhyt kuvaus",content:"Pidempi kuvaus tuotteesta.",features:["Ominaisuus 1","Ominaisuus 2"]}];o({items:e})},children:(0,t.__)("+ Lisää tuote","dude")})})]}),(0,n.jsx)("section",{...x,children:(0,n.jsx)("div",{className:"container",children:(0,n.jsxs)("div",{className:"pricing-category",children:[(0,n.jsxs)("div",{className:"category-info",children:[(0,n.jsx)(s.RichText,{tagName:"h2",value:l,onChange:e=>o({categoryTitle:e}),placeholder:(0,t.__)("Kategorian otsikko...","dude")}),(0,n.jsx)(s.RichText,{tagName:"p",value:r,onChange:e=>o({categoryDescription:e}),placeholder:(0,t.__)("Kategorian kuvaus...","dude")})]}),(0,n.jsx)("div",{className:"category-items",children:(0,n.jsxs)("div",{className:"pricing-accordion",children:[0===c.length&&(0,n.jsx)("p",{style:{color:"#999",fontStyle:"italic"},children:(0,t.__)("Lisää tuotteita sivupalkista.","dude")}),c.map((e,t)=>{const s=p===t;return(0,n.jsxs)("div",{className:"pricing-accordion-item"+(e.isPopular?" is-popular":""),"aria-expanded":s?"true":"false",onClick:()=>j(t),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),j(t))},role:"button",tabIndex:0,children:[(0,n.jsxs)("div",{className:"item-main",children:[(0,n.jsxs)("div",{className:"item-content",children:[(0,n.jsxs)("div",{className:"item-header",children:[(0,n.jsx)("h3",{children:e.title}),e.isPopular&&(0,n.jsx)("span",{className:"badge",children:"Suosituin"})]}),(0,n.jsxs)("div",{className:"item-meta",children:[(0,n.jsx)("span",{className:"price",children:e.price}),(0,n.jsx)("span",{className:"description",children:e.shortDescription})]})]}),(0,n.jsx)("span",{className:"icon","aria-hidden":"true"})]}),s&&(0,n.jsxs)("div",{className:"accordion-content",children:[(0,n.jsx)("p",{children:e.content}),e.features&&e.features.length>0&&(0,n.jsx)("ul",{children:e.features.map((e,t)=>(0,n.jsx)("li",{children:e},t))})]})]},e.id||t)})]})})]})})})]})},save:()=>null})})();